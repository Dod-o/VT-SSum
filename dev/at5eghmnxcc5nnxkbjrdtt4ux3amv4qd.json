{
    "id": "at5eghmnxcc5nnxkbjrdtt4ux3amv4qd",
    "title": "Causal Reasoning and Learning Systems",
    "info": {
        "author": [
            "Elon Portugaly, Microsoft Research, Cambridge, Microsoft Research"
        ],
        "published": "Nov. 7, 2013",
        "recorded": "September 2013",
        "category": [
            "Top->Computer Science->Decision Support",
            "Top->Computer Science->Machine Learning->On-line Learning"
        ]
    },
    "url": "http://videolectures.net/lsoldm2013_portugaly_learning_systems/",
    "segmentation": [
        [
            "OK, so we are the guys that are responsible for."
        ],
        [
            "Showing the advertisement next to the search results.",
            "If you search your favorite search engine which everyone uses.",
            "And this is where."
        ],
        [
            "Work mostly by Lamberto for Microsoft Feature Research, which I was.",
            "Uh.",
            "Fortunate enough to be involved with."
        ],
        [
            "OK, so the paid search environment is actually pretty complex one and write this because it's a multiplayer system.",
            "There's the advertisers that are placing bids on ads they want to sell their products right this.",
            "Right, so they have ads.",
            "They decide where they want to show them.",
            "Let's say they place bids on queries.",
            "That's of course a bit more complicated than that.",
            "There's the user that wants to search.",
            "They revealed their intent using the query.",
            "That's the key advantage of advertisement in paid search is that you have a very good signal the user intent.",
            "And sometimes they are even happy to initiate the commercial interaction with advertiser.",
            "That's another advantage to paid search in that it's actually not such a not like standard advertisement, which just aims to trick the user into buying things they don't need here.",
            "You actually provide users with commercial interactions that are really interested in often.",
            "If you do your job correctly and then there is the publisher which which runs a search engine but also an ad marketplace.",
            "Right and there are multiple feedback loops in the system, right?",
            "The user will adjust their future behavior according to whether they gave them a good or service or not, right?",
            "Whether we bombarded the page with advertisement, most users users will not be satisfied.",
            "The quality of the advertisers.",
            "Of course.",
            "The quality of the search results.",
            "So on this, the advertiser that advertisers that constantly monitor their return on investment or maybe not depends on what kind of advertisers are those that actually behave according to the economic principles and very rationally invest time in there and do their analysis.",
            "And there are those that just set the bids and goal.",
            "And then there is another feedback loop.",
            "With this, the learning feedback loop within the publisher, right?",
            "So the publisher has all sorts of systems going on.",
            "Some of them are machine learning systems that actually look at the data and improve themselves.",
            "But there is also feedback loops that are completely organizational and human.",
            "'cause there's lots of feedback loops going on here."
        ],
        [
            "In this short talk, I'll focus only on this one, but we do have kind of extensions of this work framework to deal with the other feedback loops too.",
            "OK."
        ],
        [
            "So we need to learn to run this marketplace.",
            "So the goal.",
            "Well, the goal is a business goal.",
            "We want to improve the market based machinery such that its long-term revenue is maximal.",
            "But right, we can't really measure long-term revenue.",
            "We can't approximate it.",
            "We don't really know how to do that.",
            "That's right.",
            "That's why there are people running businesses.",
            "So we approximate the approximate this goal by improving multiple performance measures related to all players.",
            "We want to keep players satisfied because we think that if the players are satisfied, then they will interact better with the system later.",
            "But of course we also want to increase instantaneous revenue.",
            "So the learning machinery here is not a machine, it's a whole organization with lots of people doing all sorts of stuff and making decisions, and some of them are rational, some or not.",
            "But basically the question, but they're basing their decisions on whatever indicators we might provide them, and we need to provide them the right indicators.",
            "So the goal.",
            "Our goal here."
        ],
        [
            "Is to provide data for decision making and maybe automatic automatically optimized parts of the system.",
            "Right?",
            "Maybe this starts working.",
            "What do you know?",
            "The back wall works, but the forward doesn't OK."
        ],
        [
            "So.",
            "Feedback loop problem.",
            "And going back to our wine discussion from last last evening.",
            "Why we need exploration so?",
            "Data is collected when the system operates in a certain way, right.",
            "The observed data follows a very specific specific distribution and collect.",
            "The data is then used to justify actions that change the operating point, and that's that's basically a key point.",
            "In this system, you do machine learning.",
            "You do any optimization in order to change your system.",
            "You don't do it for the sake of being able to say, hey, I predicted correctly, you want to use that.",
            "You use that by definition you've changed the distribution of your data.",
            "And that means that correlations observed on the data following the first distribution do not necessarily exist in the second distribution, i.e.",
            "Following implementing these your new decisions and this often leads to vicious cycles.",
            "So let's look at a toy exam."
        ],
        [
            "Here, so part of the write an important part of the system.",
            "Here is predicting what is the probability of a click if I show this ad for this query.",
            "Right in this context there and there's.",
            "This is the key component of the system that actually uses a major machine learning machinery.",
            "Um?",
            "So let's look at a toy example and show why this feedback loop is problematic.",
            "So let's in our toy example there are two queries, cheap diamonds and news.",
            "And let's say that common equal probability and there are three ads, cheap jewellery, cheap autos, an engagement rings OK and.",
            "These are the probability of a click for showing the different ads for the two different.",
            "The three different ads for the three different queries.",
            "This is, of course that completely toy example.",
            "Let's say that there are no bids and the goal of the system is just to maximize the number of clicks you see, right?",
            "So if we start by picking ads randomly, this is the overall percentage of clicks.",
            "Will see right half of the times were in query 1/2 of the times were in query two.",
            "If we're in query one, we pick one of the three randomly.",
            "So we have an average between 7%, two percent and 9%, and if your inquiry 2.",
            "Pick one of the three randomly and we're at 2% anyway, right?",
            "Overall we have 4%.",
            "So now let's throw in.",
            "Machine learning to try and predict what is the probability of a click.",
            "Allow."
        ],
        [
            "Let's start with the simplified model that has just one feature.",
            "Does the query have?",
            "At least one word in common with the ad.",
            "OK, that's the feature we're going to use only that feature to predict the probability of clicks, right?",
            "So in this six combinations of queries and that there are two of them where the feature is right is on and forward it off, right?",
            "So if we group the two where the feature is on together and the rest were.",
            "To another group, right?",
            "Then we have a probability of the click given that the feature is on is 7% + 2% / 2 four and a half, and the probability of the click given that the feature is off is 3.75%.",
            "So obviously we've missed a key key characteristic of the distance of the real distribution, but and obviously in this store example you can say of course that's not the right.",
            "Predictor, but the real example is much more complex than whatever machine learning you would use.",
            "Will have some cases where it systematically misses.",
            "So let's see what happens if we use our nice slightly wrong click predictor.",
            "To serve ads and remember what we want to do is maximize clicks.",
            "So what we'll do is we'll try and predict the probability of a click and will show the one ad that has the highest probability breaking ties randomly."
        ],
        [
            "So OK, so for the first query we predict the probability of a click for a 180 for the three and for the first 2 ads where the feature is on we predict the probability of four and a half for the 3rd Ed, where the feature is off, we predict the probability of 33.75 and we will discard the third one and show the 1st and the 2nd interchangeably randomly and for the second query, well, all three.",
            "Ads look the same and again we show them at random.",
            "What happens now.",
            "Now let's measure how many clicks we see and now we end up showing.",
            "We end up getting 3.25% clicks, which is lower than what we had before when we were completely.",
            "Choosing at random."
        ],
        [
            "The funny thing is, if we now measure.",
            "Sorry, now now let's retrain using the new data.",
            "And what will happen is that.",
            "Our click predictable our accuracy, the accuracy of our click predictor increased.",
            "So we're getting worse results where our accuracy is better.",
            "So something is wrong here.",
            "So what actually happened?"
        ],
        [
            "So the problem is at the end of the day we've used a.",
            "And in perfect click predictor we've changed the distribution such that we've thrown away a good ad because we've missed it.",
            "It's easier to estimate now because we've thrown away at variance for which we didn't have an answer before.",
            "So we were more accurate, but we've lost a good ad.",
            "Right?",
            "Let's add another feature that singled out that nyuad right.",
            "So that should solve the problem, right?",
            "And indeed, of course if we."
        ],
        [
            "Go back and.",
            "We add that feature, but on."
        ],
        [
            "On on random ads right?",
            "Starting from the beginning from the on the 1st traffic.",
            "Generated by random random assignment, we add that that new feature and now our predictor captures that good ad and we won't fall into that problem.",
            "But if we add that feature."
        ],
        [
            "Here to send you to the data.",
            "That we collected using the first predictor that wouldn't help, right?",
            "Because we no longer see this good feature and good ad, right?",
            "So further feature engineering based on this data would always result in eliminating more options.",
            "Right and will never recover loss options.",
            "So."
        ],
        [
            "Right?",
            "A pair of quirion ads can occasionally be sucked into such black holes.",
            "And.",
            "There are several also all kinds of events that can cause an end to disappear.",
            "And more, what is more common or more at least?",
            "More commonly thought of is that, as can be born into.",
            "Black hole, so that's again, the courts are problem.",
            "So the only way to actually tackle that is to use exploracion to not do what looks optimal in their eyes or fewer predictor.",
            "OK, so."
        ],
        [
            "I I'd like to.",
            "Talk about the language we use for this exploration here and then show how we do it.",
            "So we use the language of counterfactuals.",
            "It's a basic basing on the work of Perl and so on.",
            "What is a counterfactual?",
            "Can't function?",
            "Is measuring something that did not happen?",
            "How would the system have performed if when the data was collected, we had intervened and used P star?",
            "Instead of P, right?",
            "And if we did that, we would know that we shouldn't switch to the new predictor.",
            "In a randomized system, right this this looks like something you can't do right.",
            "It's counterfeit never happened.",
            "How would you do it?",
            "How would you know?",
            "Random assistant.",
            "You can do counterfactual estimation because it ends up writing this magical.",
            "This magical.",
            "Task of counterfactuals just boils down to estimating.",
            "Expectation under one probability using data that was collected under another probability.",
            "So that's well, we know of techniques how to do that, and I'll show some improvements to important sampling.",
            "That makes it actually usable.",
            "So if we know how to do this, then we have a causal.",
            "Learning procedure you collect data that describe the operations of operation of the system during the past time period.",
            "You find changes that would have increased the performance of the system if they had been applied during the data collection.",
            "And then you implement them and you collect data again reactivate."
        ],
        [
            "OK, so now let's look at our ad serving system.",
            "OK, yeah.",
            "Support.",
            "It requires that the two distributions are close enough, of course, and, well, I'll show us that we can.",
            "What?",
            "Of course, if there is a large enough region where the P star is not supported on the P, then you will you wouldn't be able to answer what I can show is that we provide good confidence intervals so we know when we don't know.",
            "And B we can handle.",
            "Kate, we can handle.",
            "Cases where there is a small region with no support or small region with little support, but will.",
            "I'll show you that.",
            "OK, so this is a Mac Marco factorization off the ad serving system, right?",
            "The context is comes a user with a given intent.",
            "We'd never see it, of course, and the ad inventory.",
            "Ads and bids and all that we have coming from the advertiser.",
            "The user issues a query depending on their intent.",
            "We see the query.",
            "We of course don't know what is the factor, what is the factor generating query from user intent look like?",
            "Then we have a system that would go into a selection system that go into the inventory and and bring back potential ads that are relevant to the query.",
            "Right and there are associated bids.",
            "Then comes the a system that's caused the ads with respect to the query, so that includes click prediction, but maybe other stuff.",
            "And then based on those scores and the bids, you decide what ads to show the slate of ads you're going to show, and what are their prices, right?",
            "Finally, after you've shown the user the state of ads.",
            "The user decides what to click.",
            "So we model that by these factor, which depends on the user intent, but notably does not depend on the prices of the scores or anything like that, right?",
            "Once the user decides what to click, you go and do a dot product with the with the.",
            "With the prices you get your revenue right.",
            "Then there are feedback loops going to the advertiser to the user, the learning and so on.",
            "We are assuming this away from now.",
            "We're now looking at a slice one request."
        ],
        [
            "OK, OK, So what is an intervention in this case?",
            "An intervention is this case is taking one factor and replacing it with another, right?",
            "And that brings that brings many Bayesian networks into life and they are interrelated because they share a lot of the factors and we will of course use that."
        ],
        [
            "So is this a contextual bandit?",
            "Well, OK."
        ],
        [
            "So we have the context and the reward and their IID drone.",
            "That's fine.",
            "Potential vector of rewards.",
            "And the context, and we have our action."
        ],
        [
            "An action is decided by policy given context, that's fine."
        ],
        [
            "And well, it is a contextual bandit, but note that it's very large context and action space and the restructuring, the context, reward and policy and what we're focusing on is on leveraging this."
        ],
        [
            "So important sampling.",
            "We want to measure some.",
            "Some KPI say the expected revenue under P star, so the distribution under where I've replaced this factor with the pstar quivalent of it.",
            "And we want to do that using data that was actually sampled from P. So can we do that?",
            "The answer is yes.",
            "If the randomized and close enough."
        ],
        [
            "So let's say Ello Mega so Omega is all the variables in the system.",
            "Elevon Mega says the revenue from a particular instance and we want the expected revenue or the expected clicks.",
            "And so we do this for multiple peas.",
            "And counterfactual expectation.",
            "So why Star is the integral under the P star distribution?",
            "And you can divide and multiply by P and then define this to be a reweighing way at the weight off that instance and then go and say, OK, I have this integral and I'm going to estimate it from data.",
            "That's basically important, something right?"
        ],
        [
            "Note that because we have the Markov factorization.",
            "P star over Omega over P of Omega.",
            "All factors were we didn't event cancel out and all you need is the ratio of the factors.",
            "You did intervene and so therefore we since we can't even calculate P of Omega because there are factors unknown factors there.",
            "But as long as we only intervene in factors that we know, we can calculate the weight."
        ],
        [
            "So OK again, the quality of the exploration will depend on how well they overlap, of course."
        ],
        [
            "An OK, so can we actually estimate this?",
            "Um, the answer is we can't because W can be very very large.",
            "For instance, if there is.",
            "Region where P star has support and P doesn't.",
            "Then WS Infinite but also in regions where just the support of peace shallow, there will be a small number of samples that dominate the expectation.",
            "Our solutions surprisingly is just to ignore them.",
            "But we have rigorous analysis showing why it's OK."
        ],
        [
            "So we we fix the threshold R in real.",
            "In practice what we do is we look and we throw away the top five WS.",
            "That's a bit of a cheat, but let's ignore that for a minute.",
            "And what months we've Thresh threshold are we pick a threshold and we just zero those WS where there are above that threshold and then W is bounded.",
            "Our KPI?",
            "We assume it's bounded for any instance so that the revenue you can make.",
            "One request is bounded.",
            "And therefore right what we are trying to estimate something that is bounded per instance and therefore can be estimated using.",
            "To simplify normal estimation.",
            "But then we've introduced the bias, of course, so let's bound this bias."
        ],
        [
            "And that's the trick number.",
            "Nice trick number one.",
            "So bounding the bias.",
            "So we want to bound double the difference between why star, which is what we, the counterfactual, was trying to estimate and why had star, which is what we've estimated using the cap bids the cap weight.",
            "So first, let's observe that the expectation of the weight itself is actually one right because it ends up being pieced R / P under P integral under P&P cancels out the story by itself is a distribution, so integral is 1.",
            "So and then we assume that the KPI is bounded below by zero and by above by M and the difference just ends up being since all the factors in this integral are positive, you can replace.",
            "Hell, with its upper bound.",
            "Take it out of the integral.",
            "You end up with M times the difference in the weight integrated over P. This part is, as we've shown one, and this part can be estimated because W packed is.",
            "Is a cat.",
            "So right?"
        ],
        [
            "End up with a two part confidence interval.",
            "The outer confidence interval bounds your estimate.",
            "What what you're aiming to with respect to the estimate from data and then the inner confidence in the interval bounds.",
            "Tobias, you've introduced you somewhere off together.",
            "You get a pretty.",
            "You gotta theoretically proven and actually empirically shown bound.",
            "So."
        ],
        [
            "Let's look at an example and I guess that should be.",
            "What I can show so there is a very important parameter to the system called the mainline reserve.",
            "It decides it's a threshold on the score you give an ad.",
            "Were above it.",
            "The ads can show in the main line I above the above.",
            "The organic result and below it can only show in the sidebar.",
            "And write the the city are for ads in the main line is on the order of magnitude higher than the CR.",
            "For ads in the sidebar, so it's an important component.",
            "One of the things we try to keep fixed in the system is to not show too many ads on the main line."
        ],
        [
            "So let's look at this setup.",
            "We've split the traffic into three flights, right AB&C?",
            "A being our treatment where we've randomized the mainline reserve.",
            "That's the square.",
            "Here B is the field Turkey which is the same thing, but without randomizing the reserves.",
            "The only purpose here is to show that the cost of exploration is not there right?",
            "Because the square in the field circle are sitting on top of each other.",
            "And then the empty circle is the same as the square, except we've shifted their Miller.",
            "The minimal are 18% lower.",
            "And then the blue area is our estimation of counterfactual estimation.",
            "So X axis is mainline mainline reserve.",
            "This is all relative units.",
            "For confidentiality reasons, excuse me and then Y axis is clicks brokate page and you can see that a estimate for 18% below is right on the spot and that of course as you go further away from the point where you explored your bounds.",
            "Increase and you become your estimate.",
            "Become in English.",
            "If you switch to showing."
        ],
        [
            "Revenue then of course the variance is much higher."
        ],
        [
            "So what else can we do with this so we have nice means of improving these confidence interval so exploiting the causal graph that we've just showed the Markov decomposition.",
            "We can say that instead of having the weight B, the ratio of choosing this exact value of mainline reserve versus in the two distributions, what I'm actually interested in, what is the probability of showing this late event?",
            "Because for the user, that's what matters.",
            "So if I can ask answer, what is the probability of showing these this slate of ads under P or under P star?",
            "I can get much better bounds because this ratio will be much less variant.",
            "Right, I there's actually for every given request, there's a whole interval of main and reserve values that would end up in the same.",
            "In the same Slater with the same state of it.",
            "Next is incorporating neutral predictors invariant to the manipulation.",
            "So instead of estimating the revenue, I'm estimating the offset of the revenue from whatever predictor I have.",
            "So say a predictor based on the time of the day.",
            "So again, reducing the variance.",
            "We can do counterfactuals and optimization so we can do counterfactual derivatives.",
            "What if I changed what is the expected change in revenue?",
            "A derivative of that to a change in my NP.",
            "If I change one of the parameters of the system once we have derivatives, we can do policy gradients.",
            "And we have.",
            "I mean, I don't have time to show this, but we can do an optimization where we set the main reserve and another parameter based on this query cluster based on the query and then optimize that.",
            "Counterfactually get you an optimal point on the whole vector and an right and deploy that.",
            "And then at the end there is equilibrium analysis that I won't even start to describe, but that would take care under some under assumptions of the other feedback loops.",
            "OK, I'm not going to show all these."
        ],
        [
            "So.",
            "Messages.",
            "Well, there are systems in the real world that are too complex to easily formalize an as machine learning practitioners.",
            "We should not assume to replace the whole organization that run these systems.",
            "What we need to do is assist those humans in running them.",
            "I think I. I.",
            "Show the relation between explore, exploit and correlation causation.",
            "I think these are very.",
            "These are basically the same concept and the framework is counterfactual framework, provides a region modular framework for engineering, web scale, interactive learning systems.",
            "And right I hope will implement it further and further just where I work.",
            "So that's it."
        ]
    ],
    "summarization": {
        "clip_0": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "OK, so we are the guys that are responsible for.",
                    "label": 0
                }
            ]
        },
        "clip_1": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "Showing the advertisement next to the search results.",
                    "label": 0
                },
                {
                    "sent": "If you search your favorite search engine which everyone uses.",
                    "label": 0
                },
                {
                    "sent": "And this is where.",
                    "label": 0
                }
            ]
        },
        "clip_2": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "Work mostly by Lamberto for Microsoft Feature Research, which I was.",
                    "label": 0
                },
                {
                    "sent": "Uh.",
                    "label": 0
                },
                {
                    "sent": "Fortunate enough to be involved with.",
                    "label": 0
                }
            ]
        },
        "clip_3": {
            "is_summarization_sample": true,
            "summarization_data": [
                {
                    "sent": "OK, so the paid search environment is actually pretty complex one and write this because it's a multiplayer system.",
                    "label": 0
                },
                {
                    "sent": "There's the advertisers that are placing bids on ads they want to sell their products right this.",
                    "label": 0
                },
                {
                    "sent": "Right, so they have ads.",
                    "label": 0
                },
                {
                    "sent": "They decide where they want to show them.",
                    "label": 0
                },
                {
                    "sent": "Let's say they place bids on queries.",
                    "label": 0
                },
                {
                    "sent": "That's of course a bit more complicated than that.",
                    "label": 0
                },
                {
                    "sent": "There's the user that wants to search.",
                    "label": 0
                },
                {
                    "sent": "They revealed their intent using the query.",
                    "label": 0
                },
                {
                    "sent": "That's the key advantage of advertisement in paid search is that you have a very good signal the user intent.",
                    "label": 0
                },
                {
                    "sent": "And sometimes they are even happy to initiate the commercial interaction with advertiser.",
                    "label": 0
                },
                {
                    "sent": "That's another advantage to paid search in that it's actually not such a not like standard advertisement, which just aims to trick the user into buying things they don't need here.",
                    "label": 0
                },
                {
                    "sent": "You actually provide users with commercial interactions that are really interested in often.",
                    "label": 0
                },
                {
                    "sent": "If you do your job correctly and then there is the publisher which which runs a search engine but also an ad marketplace.",
                    "label": 0
                },
                {
                    "sent": "Right and there are multiple feedback loops in the system, right?",
                    "label": 0
                },
                {
                    "sent": "The user will adjust their future behavior according to whether they gave them a good or service or not, right?",
                    "label": 0
                },
                {
                    "sent": "Whether we bombarded the page with advertisement, most users users will not be satisfied.",
                    "label": 0
                },
                {
                    "sent": "The quality of the advertisers.",
                    "label": 0
                },
                {
                    "sent": "Of course.",
                    "label": 0
                },
                {
                    "sent": "The quality of the search results.",
                    "label": 0
                },
                {
                    "sent": "So on this, the advertiser that advertisers that constantly monitor their return on investment or maybe not depends on what kind of advertisers are those that actually behave according to the economic principles and very rationally invest time in there and do their analysis.",
                    "label": 0
                },
                {
                    "sent": "And there are those that just set the bids and goal.",
                    "label": 0
                },
                {
                    "sent": "And then there is another feedback loop.",
                    "label": 1
                },
                {
                    "sent": "With this, the learning feedback loop within the publisher, right?",
                    "label": 1
                },
                {
                    "sent": "So the publisher has all sorts of systems going on.",
                    "label": 0
                },
                {
                    "sent": "Some of them are machine learning systems that actually look at the data and improve themselves.",
                    "label": 0
                },
                {
                    "sent": "But there is also feedback loops that are completely organizational and human.",
                    "label": 0
                },
                {
                    "sent": "'cause there's lots of feedback loops going on here.",
                    "label": 0
                }
            ]
        },
        "clip_4": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "In this short talk, I'll focus only on this one, but we do have kind of extensions of this work framework to deal with the other feedback loops too.",
                    "label": 0
                },
                {
                    "sent": "OK.",
                    "label": 0
                }
            ]
        },
        "clip_5": {
            "is_summarization_sample": true,
            "summarization_data": [
                {
                    "sent": "So we need to learn to run this marketplace.",
                    "label": 0
                },
                {
                    "sent": "So the goal.",
                    "label": 0
                },
                {
                    "sent": "Well, the goal is a business goal.",
                    "label": 0
                },
                {
                    "sent": "We want to improve the market based machinery such that its long-term revenue is maximal.",
                    "label": 1
                },
                {
                    "sent": "But right, we can't really measure long-term revenue.",
                    "label": 0
                },
                {
                    "sent": "We can't approximate it.",
                    "label": 0
                },
                {
                    "sent": "We don't really know how to do that.",
                    "label": 0
                },
                {
                    "sent": "That's right.",
                    "label": 0
                },
                {
                    "sent": "That's why there are people running businesses.",
                    "label": 0
                },
                {
                    "sent": "So we approximate the approximate this goal by improving multiple performance measures related to all players.",
                    "label": 1
                },
                {
                    "sent": "We want to keep players satisfied because we think that if the players are satisfied, then they will interact better with the system later.",
                    "label": 0
                },
                {
                    "sent": "But of course we also want to increase instantaneous revenue.",
                    "label": 0
                },
                {
                    "sent": "So the learning machinery here is not a machine, it's a whole organization with lots of people doing all sorts of stuff and making decisions, and some of them are rational, some or not.",
                    "label": 1
                },
                {
                    "sent": "But basically the question, but they're basing their decisions on whatever indicators we might provide them, and we need to provide them the right indicators.",
                    "label": 0
                },
                {
                    "sent": "So the goal.",
                    "label": 0
                },
                {
                    "sent": "Our goal here.",
                    "label": 0
                }
            ]
        },
        "clip_6": {
            "is_summarization_sample": true,
            "summarization_data": [
                {
                    "sent": "Is to provide data for decision making and maybe automatic automatically optimized parts of the system.",
                    "label": 1
                },
                {
                    "sent": "Right?",
                    "label": 0
                },
                {
                    "sent": "Maybe this starts working.",
                    "label": 0
                },
                {
                    "sent": "What do you know?",
                    "label": 0
                },
                {
                    "sent": "The back wall works, but the forward doesn't OK.",
                    "label": 0
                }
            ]
        },
        "clip_7": {
            "is_summarization_sample": true,
            "summarization_data": [
                {
                    "sent": "So.",
                    "label": 0
                },
                {
                    "sent": "Feedback loop problem.",
                    "label": 0
                },
                {
                    "sent": "And going back to our wine discussion from last last evening.",
                    "label": 0
                },
                {
                    "sent": "Why we need exploration so?",
                    "label": 0
                },
                {
                    "sent": "Data is collected when the system operates in a certain way, right.",
                    "label": 1
                },
                {
                    "sent": "The observed data follows a very specific specific distribution and collect.",
                    "label": 1
                },
                {
                    "sent": "The data is then used to justify actions that change the operating point, and that's that's basically a key point.",
                    "label": 0
                },
                {
                    "sent": "In this system, you do machine learning.",
                    "label": 0
                },
                {
                    "sent": "You do any optimization in order to change your system.",
                    "label": 0
                },
                {
                    "sent": "You don't do it for the sake of being able to say, hey, I predicted correctly, you want to use that.",
                    "label": 0
                },
                {
                    "sent": "You use that by definition you've changed the distribution of your data.",
                    "label": 0
                },
                {
                    "sent": "And that means that correlations observed on the data following the first distribution do not necessarily exist in the second distribution, i.e.",
                    "label": 1
                },
                {
                    "sent": "Following implementing these your new decisions and this often leads to vicious cycles.",
                    "label": 0
                },
                {
                    "sent": "So let's look at a toy exam.",
                    "label": 0
                }
            ]
        },
        "clip_8": {
            "is_summarization_sample": true,
            "summarization_data": [
                {
                    "sent": "Here, so part of the write an important part of the system.",
                    "label": 0
                },
                {
                    "sent": "Here is predicting what is the probability of a click if I show this ad for this query.",
                    "label": 0
                },
                {
                    "sent": "Right in this context there and there's.",
                    "label": 0
                },
                {
                    "sent": "This is the key component of the system that actually uses a major machine learning machinery.",
                    "label": 0
                },
                {
                    "sent": "Um?",
                    "label": 0
                },
                {
                    "sent": "So let's look at a toy example and show why this feedback loop is problematic.",
                    "label": 0
                },
                {
                    "sent": "So let's in our toy example there are two queries, cheap diamonds and news.",
                    "label": 1
                },
                {
                    "sent": "And let's say that common equal probability and there are three ads, cheap jewellery, cheap autos, an engagement rings OK and.",
                    "label": 0
                },
                {
                    "sent": "These are the probability of a click for showing the different ads for the two different.",
                    "label": 0
                },
                {
                    "sent": "The three different ads for the three different queries.",
                    "label": 0
                },
                {
                    "sent": "This is, of course that completely toy example.",
                    "label": 1
                },
                {
                    "sent": "Let's say that there are no bids and the goal of the system is just to maximize the number of clicks you see, right?",
                    "label": 0
                },
                {
                    "sent": "So if we start by picking ads randomly, this is the overall percentage of clicks.",
                    "label": 0
                },
                {
                    "sent": "Will see right half of the times were in query 1/2 of the times were in query two.",
                    "label": 0
                },
                {
                    "sent": "If we're in query one, we pick one of the three randomly.",
                    "label": 0
                },
                {
                    "sent": "So we have an average between 7%, two percent and 9%, and if your inquiry 2.",
                    "label": 0
                },
                {
                    "sent": "Pick one of the three randomly and we're at 2% anyway, right?",
                    "label": 0
                },
                {
                    "sent": "Overall we have 4%.",
                    "label": 0
                },
                {
                    "sent": "So now let's throw in.",
                    "label": 0
                },
                {
                    "sent": "Machine learning to try and predict what is the probability of a click.",
                    "label": 0
                },
                {
                    "sent": "Allow.",
                    "label": 0
                }
            ]
        },
        "clip_9": {
            "is_summarization_sample": true,
            "summarization_data": [
                {
                    "sent": "Let's start with the simplified model that has just one feature.",
                    "label": 0
                },
                {
                    "sent": "Does the query have?",
                    "label": 0
                },
                {
                    "sent": "At least one word in common with the ad.",
                    "label": 1
                },
                {
                    "sent": "OK, that's the feature we're going to use only that feature to predict the probability of clicks, right?",
                    "label": 0
                },
                {
                    "sent": "So in this six combinations of queries and that there are two of them where the feature is right is on and forward it off, right?",
                    "label": 0
                },
                {
                    "sent": "So if we group the two where the feature is on together and the rest were.",
                    "label": 0
                },
                {
                    "sent": "To another group, right?",
                    "label": 0
                },
                {
                    "sent": "Then we have a probability of the click given that the feature is on is 7% + 2% / 2 four and a half, and the probability of the click given that the feature is off is 3.75%.",
                    "label": 0
                },
                {
                    "sent": "So obviously we've missed a key key characteristic of the distance of the real distribution, but and obviously in this store example you can say of course that's not the right.",
                    "label": 0
                },
                {
                    "sent": "Predictor, but the real example is much more complex than whatever machine learning you would use.",
                    "label": 0
                },
                {
                    "sent": "Will have some cases where it systematically misses.",
                    "label": 0
                },
                {
                    "sent": "So let's see what happens if we use our nice slightly wrong click predictor.",
                    "label": 0
                },
                {
                    "sent": "To serve ads and remember what we want to do is maximize clicks.",
                    "label": 0
                },
                {
                    "sent": "So what we'll do is we'll try and predict the probability of a click and will show the one ad that has the highest probability breaking ties randomly.",
                    "label": 0
                }
            ]
        },
        "clip_10": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "So OK, so for the first query we predict the probability of a click for a 180 for the three and for the first 2 ads where the feature is on we predict the probability of four and a half for the 3rd Ed, where the feature is off, we predict the probability of 33.75 and we will discard the third one and show the 1st and the 2nd interchangeably randomly and for the second query, well, all three.",
                    "label": 0
                },
                {
                    "sent": "Ads look the same and again we show them at random.",
                    "label": 0
                },
                {
                    "sent": "What happens now.",
                    "label": 0
                },
                {
                    "sent": "Now let's measure how many clicks we see and now we end up showing.",
                    "label": 0
                },
                {
                    "sent": "We end up getting 3.25% clicks, which is lower than what we had before when we were completely.",
                    "label": 0
                },
                {
                    "sent": "Choosing at random.",
                    "label": 0
                }
            ]
        },
        "clip_11": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "The funny thing is, if we now measure.",
                    "label": 0
                },
                {
                    "sent": "Sorry, now now let's retrain using the new data.",
                    "label": 0
                },
                {
                    "sent": "And what will happen is that.",
                    "label": 0
                },
                {
                    "sent": "Our click predictable our accuracy, the accuracy of our click predictor increased.",
                    "label": 0
                },
                {
                    "sent": "So we're getting worse results where our accuracy is better.",
                    "label": 0
                },
                {
                    "sent": "So something is wrong here.",
                    "label": 0
                },
                {
                    "sent": "So what actually happened?",
                    "label": 0
                }
            ]
        },
        "clip_12": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "So the problem is at the end of the day we've used a.",
                    "label": 0
                },
                {
                    "sent": "And in perfect click predictor we've changed the distribution such that we've thrown away a good ad because we've missed it.",
                    "label": 0
                },
                {
                    "sent": "It's easier to estimate now because we've thrown away at variance for which we didn't have an answer before.",
                    "label": 0
                },
                {
                    "sent": "So we were more accurate, but we've lost a good ad.",
                    "label": 0
                },
                {
                    "sent": "Right?",
                    "label": 0
                },
                {
                    "sent": "Let's add another feature that singled out that nyuad right.",
                    "label": 0
                },
                {
                    "sent": "So that should solve the problem, right?",
                    "label": 0
                },
                {
                    "sent": "And indeed, of course if we.",
                    "label": 0
                }
            ]
        },
        "clip_13": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "Go back and.",
                    "label": 0
                },
                {
                    "sent": "We add that feature, but on.",
                    "label": 0
                }
            ]
        },
        "clip_14": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "On on random ads right?",
                    "label": 0
                },
                {
                    "sent": "Starting from the beginning from the on the 1st traffic.",
                    "label": 0
                },
                {
                    "sent": "Generated by random random assignment, we add that that new feature and now our predictor captures that good ad and we won't fall into that problem.",
                    "label": 0
                },
                {
                    "sent": "But if we add that feature.",
                    "label": 0
                }
            ]
        },
        "clip_15": {
            "is_summarization_sample": true,
            "summarization_data": [
                {
                    "sent": "Here to send you to the data.",
                    "label": 0
                },
                {
                    "sent": "That we collected using the first predictor that wouldn't help, right?",
                    "label": 0
                },
                {
                    "sent": "Because we no longer see this good feature and good ad, right?",
                    "label": 0
                },
                {
                    "sent": "So further feature engineering based on this data would always result in eliminating more options.",
                    "label": 1
                },
                {
                    "sent": "Right and will never recover loss options.",
                    "label": 0
                },
                {
                    "sent": "So.",
                    "label": 0
                }
            ]
        },
        "clip_16": {
            "is_summarization_sample": true,
            "summarization_data": [
                {
                    "sent": "Right?",
                    "label": 0
                },
                {
                    "sent": "A pair of quirion ads can occasionally be sucked into such black holes.",
                    "label": 0
                },
                {
                    "sent": "And.",
                    "label": 0
                },
                {
                    "sent": "There are several also all kinds of events that can cause an end to disappear.",
                    "label": 1
                },
                {
                    "sent": "And more, what is more common or more at least?",
                    "label": 1
                },
                {
                    "sent": "More commonly thought of is that, as can be born into.",
                    "label": 0
                },
                {
                    "sent": "Black hole, so that's again, the courts are problem.",
                    "label": 0
                },
                {
                    "sent": "So the only way to actually tackle that is to use exploracion to not do what looks optimal in their eyes or fewer predictor.",
                    "label": 0
                },
                {
                    "sent": "OK, so.",
                    "label": 0
                }
            ]
        },
        "clip_17": {
            "is_summarization_sample": true,
            "summarization_data": [
                {
                    "sent": "I I'd like to.",
                    "label": 0
                },
                {
                    "sent": "Talk about the language we use for this exploration here and then show how we do it.",
                    "label": 0
                },
                {
                    "sent": "So we use the language of counterfactuals.",
                    "label": 0
                },
                {
                    "sent": "It's a basic basing on the work of Perl and so on.",
                    "label": 0
                },
                {
                    "sent": "What is a counterfactual?",
                    "label": 0
                },
                {
                    "sent": "Can't function?",
                    "label": 0
                },
                {
                    "sent": "Is measuring something that did not happen?",
                    "label": 1
                },
                {
                    "sent": "How would the system have performed if when the data was collected, we had intervened and used P star?",
                    "label": 1
                },
                {
                    "sent": "Instead of P, right?",
                    "label": 0
                },
                {
                    "sent": "And if we did that, we would know that we shouldn't switch to the new predictor.",
                    "label": 0
                },
                {
                    "sent": "In a randomized system, right this this looks like something you can't do right.",
                    "label": 1
                },
                {
                    "sent": "It's counterfeit never happened.",
                    "label": 0
                },
                {
                    "sent": "How would you do it?",
                    "label": 0
                },
                {
                    "sent": "How would you know?",
                    "label": 0
                },
                {
                    "sent": "Random assistant.",
                    "label": 0
                },
                {
                    "sent": "You can do counterfactual estimation because it ends up writing this magical.",
                    "label": 0
                },
                {
                    "sent": "This magical.",
                    "label": 0
                },
                {
                    "sent": "Task of counterfactuals just boils down to estimating.",
                    "label": 0
                },
                {
                    "sent": "Expectation under one probability using data that was collected under another probability.",
                    "label": 0
                },
                {
                    "sent": "So that's well, we know of techniques how to do that, and I'll show some improvements to important sampling.",
                    "label": 0
                },
                {
                    "sent": "That makes it actually usable.",
                    "label": 0
                },
                {
                    "sent": "So if we know how to do this, then we have a causal.",
                    "label": 1
                },
                {
                    "sent": "Learning procedure you collect data that describe the operations of operation of the system during the past time period.",
                    "label": 0
                },
                {
                    "sent": "You find changes that would have increased the performance of the system if they had been applied during the data collection.",
                    "label": 1
                },
                {
                    "sent": "And then you implement them and you collect data again reactivate.",
                    "label": 0
                }
            ]
        },
        "clip_18": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "OK, so now let's look at our ad serving system.",
                    "label": 0
                },
                {
                    "sent": "OK, yeah.",
                    "label": 0
                },
                {
                    "sent": "Support.",
                    "label": 0
                },
                {
                    "sent": "It requires that the two distributions are close enough, of course, and, well, I'll show us that we can.",
                    "label": 0
                },
                {
                    "sent": "What?",
                    "label": 0
                },
                {
                    "sent": "Of course, if there is a large enough region where the P star is not supported on the P, then you will you wouldn't be able to answer what I can show is that we provide good confidence intervals so we know when we don't know.",
                    "label": 0
                },
                {
                    "sent": "And B we can handle.",
                    "label": 0
                },
                {
                    "sent": "Kate, we can handle.",
                    "label": 0
                },
                {
                    "sent": "Cases where there is a small region with no support or small region with little support, but will.",
                    "label": 0
                },
                {
                    "sent": "I'll show you that.",
                    "label": 0
                },
                {
                    "sent": "OK, so this is a Mac Marco factorization off the ad serving system, right?",
                    "label": 0
                },
                {
                    "sent": "The context is comes a user with a given intent.",
                    "label": 0
                },
                {
                    "sent": "We'd never see it, of course, and the ad inventory.",
                    "label": 0
                },
                {
                    "sent": "Ads and bids and all that we have coming from the advertiser.",
                    "label": 0
                },
                {
                    "sent": "The user issues a query depending on their intent.",
                    "label": 0
                },
                {
                    "sent": "We see the query.",
                    "label": 0
                },
                {
                    "sent": "We of course don't know what is the factor, what is the factor generating query from user intent look like?",
                    "label": 0
                },
                {
                    "sent": "Then we have a system that would go into a selection system that go into the inventory and and bring back potential ads that are relevant to the query.",
                    "label": 0
                },
                {
                    "sent": "Right and there are associated bids.",
                    "label": 0
                },
                {
                    "sent": "Then comes the a system that's caused the ads with respect to the query, so that includes click prediction, but maybe other stuff.",
                    "label": 0
                },
                {
                    "sent": "And then based on those scores and the bids, you decide what ads to show the slate of ads you're going to show, and what are their prices, right?",
                    "label": 0
                },
                {
                    "sent": "Finally, after you've shown the user the state of ads.",
                    "label": 0
                },
                {
                    "sent": "The user decides what to click.",
                    "label": 0
                },
                {
                    "sent": "So we model that by these factor, which depends on the user intent, but notably does not depend on the prices of the scores or anything like that, right?",
                    "label": 0
                },
                {
                    "sent": "Once the user decides what to click, you go and do a dot product with the with the.",
                    "label": 0
                },
                {
                    "sent": "With the prices you get your revenue right.",
                    "label": 0
                },
                {
                    "sent": "Then there are feedback loops going to the advertiser to the user, the learning and so on.",
                    "label": 0
                },
                {
                    "sent": "We are assuming this away from now.",
                    "label": 0
                },
                {
                    "sent": "We're now looking at a slice one request.",
                    "label": 0
                }
            ]
        },
        "clip_19": {
            "is_summarization_sample": true,
            "summarization_data": [
                {
                    "sent": "OK, OK, So what is an intervention in this case?",
                    "label": 0
                },
                {
                    "sent": "An intervention is this case is taking one factor and replacing it with another, right?",
                    "label": 0
                },
                {
                    "sent": "And that brings that brings many Bayesian networks into life and they are interrelated because they share a lot of the factors and we will of course use that.",
                    "label": 1
                }
            ]
        },
        "clip_20": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "So is this a contextual bandit?",
                    "label": 0
                },
                {
                    "sent": "Well, OK.",
                    "label": 0
                }
            ]
        },
        "clip_21": {
            "is_summarization_sample": true,
            "summarization_data": [
                {
                    "sent": "So we have the context and the reward and their IID drone.",
                    "label": 0
                },
                {
                    "sent": "That's fine.",
                    "label": 0
                },
                {
                    "sent": "Potential vector of rewards.",
                    "label": 0
                },
                {
                    "sent": "And the context, and we have our action.",
                    "label": 1
                }
            ]
        },
        "clip_22": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "An action is decided by policy given context, that's fine.",
                    "label": 0
                }
            ]
        },
        "clip_23": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "And well, it is a contextual bandit, but note that it's very large context and action space and the restructuring, the context, reward and policy and what we're focusing on is on leveraging this.",
                    "label": 0
                }
            ]
        },
        "clip_24": {
            "is_summarization_sample": true,
            "summarization_data": [
                {
                    "sent": "So important sampling.",
                    "label": 0
                },
                {
                    "sent": "We want to measure some.",
                    "label": 0
                },
                {
                    "sent": "Some KPI say the expected revenue under P star, so the distribution under where I've replaced this factor with the pstar quivalent of it.",
                    "label": 0
                },
                {
                    "sent": "And we want to do that using data that was actually sampled from P. So can we do that?",
                    "label": 0
                },
                {
                    "sent": "The answer is yes.",
                    "label": 0
                },
                {
                    "sent": "If the randomized and close enough.",
                    "label": 1
                }
            ]
        },
        "clip_25": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "So let's say Ello Mega so Omega is all the variables in the system.",
                    "label": 0
                },
                {
                    "sent": "Elevon Mega says the revenue from a particular instance and we want the expected revenue or the expected clicks.",
                    "label": 0
                },
                {
                    "sent": "And so we do this for multiple peas.",
                    "label": 0
                },
                {
                    "sent": "And counterfactual expectation.",
                    "label": 0
                },
                {
                    "sent": "So why Star is the integral under the P star distribution?",
                    "label": 0
                },
                {
                    "sent": "And you can divide and multiply by P and then define this to be a reweighing way at the weight off that instance and then go and say, OK, I have this integral and I'm going to estimate it from data.",
                    "label": 0
                },
                {
                    "sent": "That's basically important, something right?",
                    "label": 0
                }
            ]
        },
        "clip_26": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "Note that because we have the Markov factorization.",
                    "label": 0
                },
                {
                    "sent": "P star over Omega over P of Omega.",
                    "label": 0
                },
                {
                    "sent": "All factors were we didn't event cancel out and all you need is the ratio of the factors.",
                    "label": 0
                },
                {
                    "sent": "You did intervene and so therefore we since we can't even calculate P of Omega because there are factors unknown factors there.",
                    "label": 0
                },
                {
                    "sent": "But as long as we only intervene in factors that we know, we can calculate the weight.",
                    "label": 0
                }
            ]
        },
        "clip_27": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "So OK again, the quality of the exploration will depend on how well they overlap, of course.",
                    "label": 0
                }
            ]
        },
        "clip_28": {
            "is_summarization_sample": true,
            "summarization_data": [
                {
                    "sent": "An OK, so can we actually estimate this?",
                    "label": 0
                },
                {
                    "sent": "Um, the answer is we can't because W can be very very large.",
                    "label": 1
                },
                {
                    "sent": "For instance, if there is.",
                    "label": 0
                },
                {
                    "sent": "Region where P star has support and P doesn't.",
                    "label": 1
                },
                {
                    "sent": "Then WS Infinite but also in regions where just the support of peace shallow, there will be a small number of samples that dominate the expectation.",
                    "label": 0
                },
                {
                    "sent": "Our solutions surprisingly is just to ignore them.",
                    "label": 1
                },
                {
                    "sent": "But we have rigorous analysis showing why it's OK.",
                    "label": 0
                }
            ]
        },
        "clip_29": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "So we we fix the threshold R in real.",
                    "label": 0
                },
                {
                    "sent": "In practice what we do is we look and we throw away the top five WS.",
                    "label": 0
                },
                {
                    "sent": "That's a bit of a cheat, but let's ignore that for a minute.",
                    "label": 0
                },
                {
                    "sent": "And what months we've Thresh threshold are we pick a threshold and we just zero those WS where there are above that threshold and then W is bounded.",
                    "label": 0
                },
                {
                    "sent": "Our KPI?",
                    "label": 0
                },
                {
                    "sent": "We assume it's bounded for any instance so that the revenue you can make.",
                    "label": 0
                },
                {
                    "sent": "One request is bounded.",
                    "label": 0
                },
                {
                    "sent": "And therefore right what we are trying to estimate something that is bounded per instance and therefore can be estimated using.",
                    "label": 0
                },
                {
                    "sent": "To simplify normal estimation.",
                    "label": 0
                },
                {
                    "sent": "But then we've introduced the bias, of course, so let's bound this bias.",
                    "label": 0
                }
            ]
        },
        "clip_30": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "And that's the trick number.",
                    "label": 0
                },
                {
                    "sent": "Nice trick number one.",
                    "label": 0
                },
                {
                    "sent": "So bounding the bias.",
                    "label": 0
                },
                {
                    "sent": "So we want to bound double the difference between why star, which is what we, the counterfactual, was trying to estimate and why had star, which is what we've estimated using the cap bids the cap weight.",
                    "label": 0
                },
                {
                    "sent": "So first, let's observe that the expectation of the weight itself is actually one right because it ends up being pieced R / P under P integral under P&P cancels out the story by itself is a distribution, so integral is 1.",
                    "label": 0
                },
                {
                    "sent": "So and then we assume that the KPI is bounded below by zero and by above by M and the difference just ends up being since all the factors in this integral are positive, you can replace.",
                    "label": 0
                },
                {
                    "sent": "Hell, with its upper bound.",
                    "label": 0
                },
                {
                    "sent": "Take it out of the integral.",
                    "label": 0
                },
                {
                    "sent": "You end up with M times the difference in the weight integrated over P. This part is, as we've shown one, and this part can be estimated because W packed is.",
                    "label": 0
                },
                {
                    "sent": "Is a cat.",
                    "label": 0
                },
                {
                    "sent": "So right?",
                    "label": 0
                }
            ]
        },
        "clip_31": {
            "is_summarization_sample": true,
            "summarization_data": [
                {
                    "sent": "End up with a two part confidence interval.",
                    "label": 1
                },
                {
                    "sent": "The outer confidence interval bounds your estimate.",
                    "label": 1
                },
                {
                    "sent": "What what you're aiming to with respect to the estimate from data and then the inner confidence in the interval bounds.",
                    "label": 0
                },
                {
                    "sent": "Tobias, you've introduced you somewhere off together.",
                    "label": 0
                },
                {
                    "sent": "You get a pretty.",
                    "label": 0
                },
                {
                    "sent": "You gotta theoretically proven and actually empirically shown bound.",
                    "label": 0
                },
                {
                    "sent": "So.",
                    "label": 0
                }
            ]
        },
        "clip_32": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "Let's look at an example and I guess that should be.",
                    "label": 0
                },
                {
                    "sent": "What I can show so there is a very important parameter to the system called the mainline reserve.",
                    "label": 0
                },
                {
                    "sent": "It decides it's a threshold on the score you give an ad.",
                    "label": 0
                },
                {
                    "sent": "Were above it.",
                    "label": 0
                },
                {
                    "sent": "The ads can show in the main line I above the above.",
                    "label": 0
                },
                {
                    "sent": "The organic result and below it can only show in the sidebar.",
                    "label": 0
                },
                {
                    "sent": "And write the the city are for ads in the main line is on the order of magnitude higher than the CR.",
                    "label": 0
                },
                {
                    "sent": "For ads in the sidebar, so it's an important component.",
                    "label": 0
                },
                {
                    "sent": "One of the things we try to keep fixed in the system is to not show too many ads on the main line.",
                    "label": 0
                }
            ]
        },
        "clip_33": {
            "is_summarization_sample": true,
            "summarization_data": [
                {
                    "sent": "So let's look at this setup.",
                    "label": 0
                },
                {
                    "sent": "We've split the traffic into three flights, right AB&C?",
                    "label": 0
                },
                {
                    "sent": "A being our treatment where we've randomized the mainline reserve.",
                    "label": 0
                },
                {
                    "sent": "That's the square.",
                    "label": 0
                },
                {
                    "sent": "Here B is the field Turkey which is the same thing, but without randomizing the reserves.",
                    "label": 0
                },
                {
                    "sent": "The only purpose here is to show that the cost of exploration is not there right?",
                    "label": 0
                },
                {
                    "sent": "Because the square in the field circle are sitting on top of each other.",
                    "label": 0
                },
                {
                    "sent": "And then the empty circle is the same as the square, except we've shifted their Miller.",
                    "label": 0
                },
                {
                    "sent": "The minimal are 18% lower.",
                    "label": 1
                },
                {
                    "sent": "And then the blue area is our estimation of counterfactual estimation.",
                    "label": 0
                },
                {
                    "sent": "So X axis is mainline mainline reserve.",
                    "label": 0
                },
                {
                    "sent": "This is all relative units.",
                    "label": 0
                },
                {
                    "sent": "For confidentiality reasons, excuse me and then Y axis is clicks brokate page and you can see that a estimate for 18% below is right on the spot and that of course as you go further away from the point where you explored your bounds.",
                    "label": 0
                },
                {
                    "sent": "Increase and you become your estimate.",
                    "label": 0
                },
                {
                    "sent": "Become in English.",
                    "label": 0
                },
                {
                    "sent": "If you switch to showing.",
                    "label": 0
                }
            ]
        },
        "clip_34": {
            "is_summarization_sample": false,
            "summarization_data": [
                {
                    "sent": "Revenue then of course the variance is much higher.",
                    "label": 0
                }
            ]
        },
        "clip_35": {
            "is_summarization_sample": true,
            "summarization_data": [
                {
                    "sent": "So what else can we do with this so we have nice means of improving these confidence interval so exploiting the causal graph that we've just showed the Markov decomposition.",
                    "label": 0
                },
                {
                    "sent": "We can say that instead of having the weight B, the ratio of choosing this exact value of mainline reserve versus in the two distributions, what I'm actually interested in, what is the probability of showing this late event?",
                    "label": 0
                },
                {
                    "sent": "Because for the user, that's what matters.",
                    "label": 0
                },
                {
                    "sent": "So if I can ask answer, what is the probability of showing these this slate of ads under P or under P star?",
                    "label": 0
                },
                {
                    "sent": "I can get much better bounds because this ratio will be much less variant.",
                    "label": 0
                },
                {
                    "sent": "Right, I there's actually for every given request, there's a whole interval of main and reserve values that would end up in the same.",
                    "label": 0
                },
                {
                    "sent": "In the same Slater with the same state of it.",
                    "label": 0
                },
                {
                    "sent": "Next is incorporating neutral predictors invariant to the manipulation.",
                    "label": 1
                },
                {
                    "sent": "So instead of estimating the revenue, I'm estimating the offset of the revenue from whatever predictor I have.",
                    "label": 0
                },
                {
                    "sent": "So say a predictor based on the time of the day.",
                    "label": 0
                },
                {
                    "sent": "So again, reducing the variance.",
                    "label": 1
                },
                {
                    "sent": "We can do counterfactuals and optimization so we can do counterfactual derivatives.",
                    "label": 0
                },
                {
                    "sent": "What if I changed what is the expected change in revenue?",
                    "label": 0
                },
                {
                    "sent": "A derivative of that to a change in my NP.",
                    "label": 0
                },
                {
                    "sent": "If I change one of the parameters of the system once we have derivatives, we can do policy gradients.",
                    "label": 0
                },
                {
                    "sent": "And we have.",
                    "label": 0
                },
                {
                    "sent": "I mean, I don't have time to show this, but we can do an optimization where we set the main reserve and another parameter based on this query cluster based on the query and then optimize that.",
                    "label": 0
                },
                {
                    "sent": "Counterfactually get you an optimal point on the whole vector and an right and deploy that.",
                    "label": 0
                },
                {
                    "sent": "And then at the end there is equilibrium analysis that I won't even start to describe, but that would take care under some under assumptions of the other feedback loops.",
                    "label": 0
                },
                {
                    "sent": "OK, I'm not going to show all these.",
                    "label": 0
                }
            ]
        },
        "clip_36": {
            "is_summarization_sample": true,
            "summarization_data": [
                {
                    "sent": "So.",
                    "label": 0
                },
                {
                    "sent": "Messages.",
                    "label": 0
                },
                {
                    "sent": "Well, there are systems in the real world that are too complex to easily formalize an as machine learning practitioners.",
                    "label": 1
                },
                {
                    "sent": "We should not assume to replace the whole organization that run these systems.",
                    "label": 0
                },
                {
                    "sent": "What we need to do is assist those humans in running them.",
                    "label": 0
                },
                {
                    "sent": "I think I. I.",
                    "label": 0
                },
                {
                    "sent": "Show the relation between explore, exploit and correlation causation.",
                    "label": 0
                },
                {
                    "sent": "I think these are very.",
                    "label": 1
                },
                {
                    "sent": "These are basically the same concept and the framework is counterfactual framework, provides a region modular framework for engineering, web scale, interactive learning systems.",
                    "label": 0
                },
                {
                    "sent": "And right I hope will implement it further and further just where I work.",
                    "label": 0
                },
                {
                    "sent": "So that's it.",
                    "label": 0
                }
            ]
        }
    }
}